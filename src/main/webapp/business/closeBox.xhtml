<ui:composition  template="../masterpage.xhtml" xmlns="http://www.w3.org/1999/xhtml"
                 xmlns:h="http://xmlns.jcp.org/jsf/html"
                 xmlns:ui="http://java.sun.com/jsf/facelets" 
                 xmlns:f="http://java.sun.com/jsf/core"
                 xmlns:p="http://primefaces.org/ui">
    <ui:define name="title">
        #{labels.close_box}
    </ui:define>
    <ui:define name="center"> 
        <h:body>              
            <h:form id="form" onkeypress="if (event.keyCode == 13) { event.preventDefault();return false;}">  
                <p:fieldset legend="#{labels.close_box}">
                    <table width="100%">
                        <tr>
                            <td align="center">
                                <p:clock pattern="dd/MMM/yyyy hh:mm:ss a" mode="server"/>
                            </td>
                        </tr>
                    </table>                    
                    <div id="divContainer" style="margin:0 auto; alignment-adjust:central">
                        <div width="50%" style="float:left">
                            <p:fieldset legend="#{labels.cash}" style="width:20%">
                                <table>
                                    <tr>
                                        <td align="center">                                        
                                            <h:outputText value="#{labels.bills_of}"/>
                                        </td>
                                        <td align="center">
                                            <h:outputText value="#{labels.quatity}"/>
                                        </td>
                                        <td align="center">
                                            <h:outputText value="#{labels.values}"/>
                                        </td>
                                    </tr>                        
                                    <tr>
                                        <td align="right">                                        
                                            <h:outputText value="#{labels.two_thousand}"/> 
                                        </td>
                                        <td align="right">
                                            <p:inputText id="txtTwoThousand" tabindex="1" style="width:30px" value="#{closeBoxController.twoThousandQty}">  
                                                <p:ajax event="blur" update=":form:lbltwoThousand :form:lblTotalAmount :form:lblDifference :form:lblDifference2"/> 
                                            </p:inputText>    
                                        </td>
                                        <td align="right">
                                            <b><h:outputText id="lbltwoThousand" value="#{closeBoxController.twoThousandLabelAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">                                        
                                            <h:outputText value="#{labels.one_thousand}"/>
                                        </td>
                                        <td align="right">
                                            <p:inputText id="txtOneThousand" tabindex="2" style="width:30px" value="#{closeBoxController.oneThousandQty}">  
                                                <p:ajax event="blur" update=":form:lblOneThousand :form:lblTotalAmount :form:lblDifference :form:lblDifference2"/> 
                                            </p:inputText>
                                        </td>
                                        <td align="right">
                                            <b><h:outputText id="lblOneThousand" value="#{closeBoxController.oneThousandLabelAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">                                        
                                            <h:outputText value="#{labels.five_hundred}"/>
                                        </td>
                                        <td align="right">
                                            <p:inputText id="txtFiveThousand" tabindex="3" style="width:30px" value="#{closeBoxController.fiveHundredQty}">  
                                                <p:ajax event="blur" update=":form:lblFiveHundred :form:lblTotalAmount :form:lblDifference :form:lblDifference2"/> 
                                            </p:inputText>
                                        </td>
                                        <td align="right">
                                            <b><h:outputText id="lblFiveHundred" value="#{closeBoxController.fiveHundredLabelAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">                                        
                                            <h:outputText value="#{labels.thow_hundred}"/>
                                        </td>
                                        <td align="right">
                                            <p:inputText id="txtTwoHundred" tabindex="4" style="width:30px" value="#{closeBoxController.twoHundredQty}">
                                                <p:ajax event="blur" update=":form:lblTwoHundred :form:lblTotalAmount :form:lblDifference :form:lblDifference2"/>
                                            </p:inputText>    
                                        </td>
                                        <td align="right">
                                            <b><h:outputText id="lblTwoHundred" value="#{closeBoxController.twoHundredLabelAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">                                        
                                            <h:outputText value="#{labels.one_hundred}"/>
                                        </td>
                                        <td align="right">
                                            <p:inputText id="txtOneHundred" tabindex="5" style="width:30px" value="#{closeBoxController.oneHundredQty}">  
                                                <p:ajax event="blur" update=":form:lblOneHundred :form:lblTotalAmount :form:lblDifference :form:lblDifference2"/>
                                            </p:inputText>
                                        </td>
                                        <td align="right">
                                            <b><h:outputText id="lblOneHundred" value="#{closeBoxController.oneHundredLabelAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">                                        
                                            <h:outputText value="#{labels.fifty}"/>
                                        </td>
                                        <td align="right">
                                            <p:inputText id="txtFifty" tabindex="6" style="width:30px" value="#{closeBoxController.fiftyQty}">
                                                <p:ajax event="blur" update=":form:lblFifty :form:lblTotalAmount :form:lblDifference :form:lblDifference2"/>
                                            </p:inputText>    
                                        </td>
                                        <td align="right">
                                            <b><h:outputText id="lblFifty" value="#{closeBoxController.fiftyLabelAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">                                        
                                            <h:outputText value="#{labels.twenty_five}"/>
                                        </td>
                                        <td align="right">
                                            <p:inputText id="txtTwentyFive" tabindex="7" style="width:30px" value="#{closeBoxController.twentyFiveQty}">  
                                                <p:ajax event="blur" update=":form:lblTwentyFive :form:lblTotalAmount :form:lblDifference :form:lblDifference2"/>
                                            </p:inputText>    
                                        </td>
                                        <td align="right">
                                            <b><h:outputText id="lblTwentyFive" value="#{closeBoxController.twentyFiveLabelAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">                                        
                                            <h:outputText value="#{labels.twenty}"/>
                                        </td>
                                        <td align="right">
                                            <p:inputText id="txtTwenty" tabindex="8" style="width:30px" value="#{closeBoxController.twentyQty}">
                                                <p:ajax event="blur" update=":form:lblTwenty :form:lblTotalAmount :form:lblDifference :form:lblDifference2"/>
                                            </p:inputText>
                                        </td>
                                        <td align="right">
                                            <b><h:outputText id="lblTwenty" value="#{closeBoxController.twentyLabelAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">                           
                                            <h:outputText value="#{labels.ten}"/>
                                        </td>
                                        <td align="right">
                                            <p:inputText id="txtTen" tabindex="9" style="width:30px" value="#{closeBoxController.tenQty}">
                                                <p:ajax event="blur" update=":form:lblTen :form:lblTotalAmount :form:lblDifference :form:lblDifference2"/>
                                            </p:inputText>                                                    
                                        </td>
                                        <td align="right">
                                            <b><h:outputText id="lblTen" value="#{closeBoxController.tenLabelAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">                                        
                                            <h:outputText value="#{labels.five}"/>
                                        </td>
                                        <td align="right">
                                            <p:inputText id="txtFive" tabindex="10" style="width:30px" value="#{closeBoxController.fiveQty}">
                                                <p:ajax event="blur" update=":form:lblFive :form:lblTotalAmount :form:lblDifference :form:lblDifference2"/>
                                            </p:inputText>    
                                        </td>
                                        <td align="right">
                                            <b><h:outputText id="lblFive" value="#{closeBoxController.fiveLabelAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">                           
                                            <h:outputText value="#{labels.one}"/>
                                        </td>
                                        <td align="right">
                                            <p:inputText id="txtOne" tabindex="11" style="width:30px" value="#{closeBoxController.oneQty}">
                                                <p:ajax event="blur" update=":form:lblOne :form:lblTotalAmount :form:lblDifference :form:lblDifference2"/>
                                            </p:inputText>    
                                        </td>
                                        <td align="right">
                                            <b><h:outputText id="lblOne" value="#{closeBoxController.oneLabelAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">                           

                                        </td>
                                        <td>
                                            <b><h:outputText value="Total"/>:</b>
                                        </td>
                                        <td align="right" style="border-top:solid 1px">
                                            <b><h:outputText id ="lblTotalAmount" value="#{closeBoxController.totalAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">                           

                                        </td>
                                        <td>
                                            <b><h:outputText value="Diferencia"/>:</b>
                                        </td>
                                        <td align="right" style="border-top:solid 1px">
                                            <b><h:outputText id ="lblDifference2" value="#{closeBoxController.differenceAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td align="right">                           

                                        </td>
                                        <td>
                                            <p:commandButton process="@this" id="btnOK" 
                                                             value="#{labels.ok}"
                                                             ajax="false"
                                                             onclick="form.target = '_blank'"
                                                             actionListener="#{closeBoxController.downloadFile}"
                                                             />
                                        </td>
                                        <td align="right" style="border-top:solid 1px">
                                            <p:commandButton id="btnCancel" 
                                                             value="#{labels.cancel}" 
                                                             actionListener="#{closeBoxController.cancel}" 
                                                             update=":form"
                                                             />
                                        </td>
                                    </tr>
                                </table>
                            </p:fieldset>                            
                        </div>
                        <div width="50%">
                            <p:fieldset legend="#{labels.resumen}" style="width:20%">
                                <table>
                                    <tr>
                                        <td>
                                            <h:outputText value="#{labels.total_sell_amount}"/>:
                                        </td>
                                        <td align="right">
                                            <b><h:outputText value="#{closeBoxController.totalSellTicketAmount}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:outputText value="#{labels.total_payed}"/>:
                                        </td>
                                        <td align="right">
                                            <b><h:outputText value="#{closeBoxController.totalPayedTicket}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:outputText value="#{labels.total_in_box}"/>:
                                        </td>
                                        <td align="right">
                                            <b><h:outputText value="#{closeBoxController.totalInBoxAmountt}"/></b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <h:outputText value="#{labels.total_in_cash}"/>:
                                        </td>
                                        <td align="right">
                                            <b><h:outputText value="#{closeBoxController.totalInCashAmountt}"/></b>
                                        </td>
                                    </tr>                                
                                    <tr>
                                        <td>
                                            <h:outputText value="#{labels.difference}"/>:
                                        </td>
                                        <td align="right">
                                            <b><h:outputText id="lblDifference" value="#{closeBoxController.differenceAmount}"/></b>
                                        </td>
                                    </tr>                                    
                                </table>
                            </p:fieldset>                            
                        </div>                        
                    </div>                    
                </p:fieldset>
            </h:form>
            <script type="text/javascript">
                //<![CDATA[
                $(function() {
                    var allInputs = $(":input");
                    allInputs[6].focus();
                    allInputs.each(function()
                    {
                        //Si presiona enter, funciona como tab.
                        $(this).keypress(function(event) {
                            if (event.keyCode == 13) {
                                var currentIndex = allInputs.index($(this));
                                //Si es el ultimo input, los ubicamos en el primero
                                if (currentIndex == 16) {
                                    allInputs[6].focus();
                                }
                                else {
                                    allInputs[currentIndex + 1].focus();
                                }
                            }
                        });
                    });
                });
                //]]>
            </script>
        </h:body>
    </ui:define>
</ui:composition>