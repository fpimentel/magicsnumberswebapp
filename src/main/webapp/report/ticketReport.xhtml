<ui:composition  template="../masterpage.xhtml" xmlns="http://www.w3.org/1999/xhtml"
                 xmlns:h="http://xmlns.jcp.org/jsf/html"
                 xmlns:ui="http://java.sun.com/jsf/facelets" 
                 xmlns:f="http://java.sun.com/jsf/core"
                 xmlns:p="http://primefaces.org/ui">
    <ui:define name="title">
        #{labels.Query_ticketSale}
    </ui:define>
    <ui:define name="center">   
        <h:form id="form">  
            <p:growl id="messages" showDetail="true"/>  

            <p:fieldset legend="Parámetros de búsqueda" style="width:50%">
                <table >
                    <tr>
                        <td style="width:100px">
                            <h:outputText value="#{labels.consortium}" /> 
                        </td>
                        <td >
                            <p:selectOneMenu id="cbConsortium" value="#{ticketReportController.selectedConsortium}" valueChangeListener="#{ticketReportController.getBetBankingByConsortiumOnChange}" 
                                             widgetVar="cbConsortiumSelectMenu" effect="fade" converter="#{consortiumConverter}">  
                                <f:selectItem itemLabel="Seleccionar" itemValue=""   />
                                <f:selectItems value="#{ticketReportController.consortiums}" var="consortium" itemLabel="#{consortium.name}" itemValue="#{consortium}"/>  
                                <p:ajax event="change" update="cbBetBanking"/>                             
                            </p:selectOneMenu>
                        </td>
                        <td >
                            <h:outputText value="#{labels.betbankings}"  /> 
                        </td>
                        <td >
                            <p:selectOneMenu id="cbBetBanking" value="#{ticketReportController.selectedBetBanking}"                                               
                                             valueChangeListener="#{ticketReportController.getLotteriesByBetBankingOnChange}" 
                                             widgetVar="cbBetBankingSelectMenu" effect="fade" converter="#{betBakingConverter}">  
                                <f:selectItem itemLabel="Seleccionar" itemValue=""   />
                                <f:selectItems value="#{ticketReportController.betBankings}" var="betBanking" itemLabel="#{betBanking.name}" itemValue="#{betBanking}"/>                                  
                            </p:selectOneMenu>
                        </td>                
                    </tr>                     
                    <tr>
                        <td style="width:100px">
                            <h:outputText value="#{labels.starting_date}"  /> 
                        </td>
                        <td>
                            <p:calendar value="#{ticketReportController.startingDate}" pattern="dd/MM/yyyy" />
                        </td>
                        <td>
                            <h:outputText value="#{labels.finish_date}"  /> 
                        </td>
                        <td>
                            <p:calendar value="#{ticketReportController.finishDate}" pattern="dd/MM/yyyy" />
                        </td>
                        <td>
                            <p:commandButton process="@this" id="btnNewBetBanking" value="#{labels.search}"                             
                              immediate="true" />
                        </td>                         
                    </tr>                                        
                </table>    
            </p:fieldset>
            <p:dataTable id="dtTicket" var="ticket" value="#{ticketReportController.ticketDataModel}" paginator="true" rows="10"  
                         selection="#{ticketReportController.selectedTicket}" selectionMode="single" >  
                <f:facet name="header"  >  
                    #{labels.betBanking_title}
                </f:facet> 
                <p:ajax event="rowSelect" listener="#{betBankingController.onRowSelect}"   
                        update=":form:dialog :form:messages" oncomplete="betBankingDialog.show()"  />  
                <p:ajax event="rowUnselect" listener="#{betBankingController.onRowUnselect}" update=":form:messages"/>  

                <p:column headerText="#{labels.name}" style="width:8%" sortBy="#{ticket.creationDate}" filterBy="#{ticket.creationDate}"  filterMatchMode="contains">  
                    #{ticket.creationDate}  
                </p:column>
                <p:column headerText="#{labels.name}" style="width:8%" sortBy="#{ticket.id}" filterBy="#{ticket.id}"  filterMatchMode="contains">  
                    #{ticket.id}  
                </p:column>
                <p:column headerText="#{labels.name}" style="width:8%" sortBy="#{ticket.creationDate}" filterBy="#{ticket.creationDate}"  filterMatchMode="contains">  
                    #{ticket.creationDate}  
                </p:column>
                <p:column headerText="#{labels.status}" style="width:8%" sortBy="#{betBanking.status.name}" filterBy="#{betBanking.status.name}"  filterMatchMode="contains">  
                    #{betBanking.status.name}  
                </p:column>             
            </p:dataTable>  
        </h:form>
    </ui:define>
</ui:composition>